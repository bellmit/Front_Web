/*
 name:credit_manage/index;
 author:yipin;
 date:2016-05-17;
version:1.0.0;
*/
require.config({baseUrl:"../js/",paths:{jquery:"lib/jquery/jquery-2.1.4.min",jquery_mobile:"lib/jquery/jquery-mobile.min",dialog:"lib/artDialog/dialog",rule:"widgets/rules",commonfn:"widgets/commonfn",validform:"plugins/validform",slide:"widgets/slide"},shim:{dialog:{deps:["jquery"]},jquery_mobile:{deps:["jquery"]},validform:{deps:["jquery"]}}}),require(["jquery","jquery_mobile","dialog","rule","commonfn","validform","slide"],function(a,b,c,d,e,c,f){a(function(){var b=a("#header_menu"),c=b.children(),d=a("#header_btn"),g=a("#screen_index"),h=a("#screen_product"),i=a("#screen_scene"),j=a("#screen_self"),k=a("#screen_app"),l=a("#screen_contact"),m=a("#screen_help"),n=a("#help_btn"),o=a("#help_detail"),p=o.children(),q=a(window),r=[{node:g,pos:0},{node:h,pos:0},{node:i,pos:0},{node:j,pos:0},{node:k,pos:0},{node:l,pos:0},{node:m,pos:0}],s=!1,t=a("#contact_form"),u=a("#username"),v=a("#useremail"),w=a("#remark"),x=null,y=dialog(),z=[{ele:u,datatype:"*",nullmsg:"名称不能为空",errormsg:"",sucmsg:""},{ele:v,datatype:"selfemail",nullmsg:"邮箱不能为空",errormsg:"邮箱格式不规范",sucmsg:""},{ele:w,datatype:"*",nullmsg:"描述信息不能为空",errormsg:"",sucmsg:""}];!function(){var b=0,d=r.length,e=a(window).scrollTop();for(b;d>b;b++){var f=r[b].node.offset().top;r[b].pos=f;var g=parseInt(e-150,0),h=parseInt(e+150,0);f>=g&&h>=f&&c.eq(b).addClass("menu-active").siblings().removeClass("menu-active")}var i=q.width();s=!(i>=1200);var j=n.height();parseInt(j,10)<420?n.addClass("help-wrap-support"):n.removeClass("help-wrap-support")}(),b.on(a.EventName.click,"li",function(b){b.preventDefault();var c=a(this),d=c.index();return s?a("html,body").animate({scrollTop:r[d].pos-40+"px"},500):a("html,body").animate({scrollTop:r[d].pos-120+"px"},500),!1}),d.on(a.EventName.click,function(){d.hasClass("header-btnactive")?(d.removeClass("header-btnactive"),b.removeClass("g-d-showi")):(d.addClass("header-btnactive"),b.addClass("g-d-showi"))}),n.on(a.EventName.click,"li",function(){var b=a(this),c=b.index();switch(c){case 0:p.eq(c).animate({left:"0",top:"0"},500);break;case 1:p.eq(c).animate({right:"0",top:"0"},500);break;case 2:p.eq(c).animate({left:"0",top:"0"},500);break;case 3:p.eq(c).animate({right:"0",top:"0"},500)}});var A=0;q.on("scroll resize",function(e){var f=e.type;"scroll"==f&&!function(){if(A++,A%2==0){var b=a(this),d=b.scrollTop(),e=0,f=r.length;for(e;f>e;e++){var g=r[e].pos,h=parseInt(g-150,0),i=parseInt(g+150,0);d>=h&&i>=d&&c.eq(e).addClass("menu-active").siblings().removeClass("menu-active")}}}(),"resize"==f&&!function(){var a=q.width();a>=1200||a>=1200&&"landscape"==e.orientation?(d.removeClass("header-btnactive"),b.removeClass("g-d-showi"),s=!1):s=!0;var f=0,g=r.length,h=q.scrollTop();for(f;g>f;f++){var i=r[f].node.offset().top;r[f].pos=i;var j=parseInt(h-150,0),k=parseInt(h+150,0);i>=j&&k>=i&&c.eq(f).addClass("menu-active").siblings().removeClass("menu-active")}var l=n.height();parseInt(l,10)<420?n.addClass("help-wrap-support"):n.removeClass("help-wrap-support")}()}),n.on(a.EventName.click,"li",function(){var b=a(this),c=b.index(),d=500;0===c||2===c?p.eq(c).animate({left:"0",top:"0"},d):1!==c&&3!==c||p.eq(c).animate({right:"0",top:"0"},d)}),o.on(a.EventName.click,function(b){var c,d,e=b.target,f=e.nodeName.toLowerCase(),g=500;if("ul"===f)return!1;switch("li"===f?(c=a(e),d=c.index()):(c=a(e).closest("li"),d=c.index()),d){case 0:c.animate({left:"100%",top:"100%"},g);break;case 1:c.animate({right:"100%",top:"100%"},g);break;case 2:c.animate({left:"100%",top:"-100%"},g);break;case 3:c.animate({right:"100%",top:"-100%"},g)}0!==d&&1!==d&&2!==d&&3!==d||setTimeout(function(){c.removeAttr("style")},parseInt(g+10,10))}),x=t.Validform({ajaxPost:!0,datatype:{selfemail:function(a,b,c,d){return e.isEmail(a)}},beforeSubmit:function(b){var c={};return c.UserName=u.val(),c.UserEmail=v.val(),c.Remak=w.val(),a.ajax({url:"../json/contact.json",type:"post",dataType:"json",data:c,success:function(a){a.flag?(y.content('<span class="g-c-succ">保存成功</span>').show(),setTimeout(function(){y.close()},3e3)):(y.content('<span class="g-c-warn">保存失败</span>').show(),setTimeout(function(){y.close()},3e3))},error:function(){y.content('<span class="g-c-err">保存失败</span>').show(),setTimeout(function(){y.close()},3e3)}}),!1},tiptype:function(a,b){var c=b.type,d=b.obj;1==c||3==c?d.parent().next().text(a):2==c&&d.parent().next().text("")}}),x.addRule(z),f.slideToggle({$wrap:a("#slideimg_show"),$slide_img:a("#slide_img"),$btnwrap:a("#slideimg_btn"),$slide_tipwrap:a("#slide_tips"),minwidth:214,winwidth:214,isresize:!1,size:3,times:5e3,eff_time:500,btn_active:"slidebtn-active"})})});