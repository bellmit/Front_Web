/**
name:credit_manage / commonfn;
 author:yipin;
 date:2016-06-06;
 version:1.0.0**/
define(["rule"],function(rules){return{pwdStrong:function(a,b,c){var d=0,e=this.trims(a),f=""==e?0:e.length,g=/[a-zA-Z]+/,h=/[0-9]+/,i=/\W+\D+/;f>=c[0]&&f<=c[1]?(g.test(e)&&h.test(e)&&i.test(e)?d=90:(g.test(e)||h.test(e)||i.test(e))&&(d=g.test(e)&&h.test(e)?60:g.test(e)&&i.test(e)?60:h.test(e)&&i.test(e)?60:30),50>=d?b.removeClass().addClass("g-c-gray2").html("低级"):79>=d&&d>50?b.removeClass().addClass("g-c-orange").html("中级"):d>=80&&b.removeClass().addClass("g-c-red4").html("高级")):""==e||"null"==e?b.removeClass().addClass("g-c-gray2").html(""):""!=e&&f<c[0]?b.removeClass().addClass("g-c-red4").html("密码长度至少大于"+c[0]+"位"):b.removeClass().addClass("g-c-gray2").html("")},getCount:function(a,b,c,d,e){var f=0,g=a,h=b,i=c;i.html(b+"秒后重新获取").prop("disabled",!0).addClass(e),timer=this.getTimer(),g=setInterval(function(){f=timer(),f=h>=f?f:f%h,i.html(h-f+"秒后重新获取"),f!=h&&0!=f||(clearInterval(g),a=null,g=null,i.prop("disabled",!1).removeClass(e).html(function(){return c.attr("data-value")?c.attr("data-value"):d}))},1e3)},trimSep:function(a,b){return a.replace(new RegExp("\\"+b,"g"),"")},trims:function(a){return a.replace(/\s*/g,"")},trim:function(a){return a.replace(/^\s*\s*$/,"")},isEmail:function(a){return!!rules.email.test(this.trims(a))},isMobilePhone:function(a){return!!rules.mobilephone.test(this.trims(a))},isEMP:function(a){return!(!this.isEmail(a)&&!this.isMobilePhone(a))},isUserName:function(a){return!!rules.username.test(this.trims(a))},isRequire:function(a){return""==this.trims(a)},isEqual:function(a,b){return this.trims(a)==this.trims(b)},isNum:function(a){return!!rules.num.test(this.trims(a))},isMinMax:function(a,b){var c=a.length;return(c<b[1]||c==b[1])&&(c>b[0]||c==b[0])},isInjection:function(a){return rules.injections.test(this.trims(a))},replaceInjection:function(a){var b="",c=a.toString(),d=0,e=c.length;for(d;e>d;d++)b+=c.charAt(d).replace(rules.injection,"");return b},getTimer:function(){var a=0;return function(){return++a}},isMoneyY:function(a){return!!rules.moneyy.test(this.trims(a))},isMoneyQW:function(a){return!!rules.moneyqw.test(this.trims(a))},isMoneyBW:function(a){return!!rules.moneybw.test(this.trims(a))},isMoneySW:function(a){return!!rules.moneysw.test(this.trims(a))},isMoneyW:function(a){return!!rules.moneyw.test(this.trims(a))},isMoneyQ:function(a){return!!rules.moneyq.test(this.trims(a))},isMoneyB:function(a){return!!rules.moneyb.test(this.trims(a))},isMoney:function(a){return!!rules.money.test(this.trims(a))},isIDCard:function(a){var b={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"},c=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],d=[1,0,"x",9,8,7,6,5,4,3,2],e=this.trims(a.toString()),f=e.length;if(""==e||15>f||f>15&&18>f||f>18)return!1;var g=0,h=0;if(18==f?g=e.slice(0,17).replace(/\D*/g,""):15==f&&(g=e.slice(0,14).replace(/\D*/g,"")),h=g.length,14>h||h>14&&17>h)return!1;if(null==b[e.slice(0,2)])return!1;var i,j,k,l;if(18==f?(i=parseInt(e.slice(6,10)),j=parseInt(e.slice(10,12)),k=parseInt(e.slice(12,14)),l=parseInt(e.slice(16,17))):15==f&&(i=parseInt(e.slice(6,8))+1900,j=parseInt(e.slice(8,10)),k=parseInt(e.slice(10,12)),l=parseInt(e.slice(14))),j>12||1>j)return!1;if(1>k)return!1;var m=this.isLeapYear(i,j);if(m.isly&&2==j&&k>29||!m.isly&&2==j&&k>28||2!=j&&m.m<k)return!1;if(18==f){var n=e.split(""),o=0,p=0,q=0,r=parseInt(e.slice(17)),s=0;for(isNaN(r)&&(r="x"),p;17>p;p++)o+=c[p]*parseInt(n[p]);if(q=o%11,s=d[q],r!=s)return!1}return!0},isLeapYear:function(a,b){var c=[31,28,31,30,31,30,31,31,30,31,30,31],d=a%4==0&&a%100!=0?!0:a%400==0;return d?c.splice(1,1,29):c.splice(1,1,28),b?{isly:d,months:c,m:c[parseInt(b,10)-1]}:{isly:d,months:c}},toUpMoney:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q="零",r="壹",s="贰",t="叁",u="肆",v="伍",w="陆",x="柒",y="捌",z="玖",A="拾",B="佰",C="仟",D="万",E="亿",F="",G="元",H="角",I="分",J="整",K=a.toString(),L=K.replace(/^0+/,""),f=L.split(".");if(f.length>1?(c=f[0],d=f[1],d=d.slice(0,2)):(c=f[0],d=""),g=[q,r,s,t,u,v,w,x,y,z],h=["",A,B,C],i=["",D,E],j=[H,I],e="",Number(c)>0){for(k=0,l=0;l<c.length;l++)m=c.length-l-1,n=c.substr(l,1),o=m/4,p=m%4,"0"==n?k++:(k>0&&(e+=g[0]),k=0,e+=g[Number(n)]+h[p]),0==p&&4>k&&(e+=i[o]);e+=G}if(""!=d)for(l=0;l<d.length;l++)n=d.substr(l,1),"0"!=n&&(e+=g[Number(n)]+j[l]);return""==e&&(e=q+G),""==d&&(e+=J),e=F+e,b?b.innerHTML=e:e},moneyCorrect:function(a){var b,c,d,e=this.trimSep(a.toString(),","),f=0,g="";if(e=this.trims(e),""==e)return["0.00","0.00"];-1!=e.lastIndexOf(".")?(b=e.split("."),f=b.length,f>2?(c=b[f-2],d=b[f-1]):(c=b[0],d=b[1]),rules.num.test(d)||(d=d.replace(/\D*/g,"")),0==d.length?d=".00":1==d.length?d="."+d+"0":d.length>=2&&(d="."+d.slice(0,2))):(c=e,d=".00"),rules.num.test(c)||(c=c.replace(/\D*/g,"")),g=c+d;var h=c.length;if(h>3){var i=0,j=1;for(c=c.split("").reverse(),i;h>i;i++)j%3==0&&j!=h&&c.splice(i,1,","+c[i].toString()),j++;c=c.reverse().join("")}else 0==h&&(c="0");return c.length>=2&&("0"!=c.charAt(0)&&0!=c.charAt(0)||(c=c.slice(1))),[c+d,g]},cursorPos:function(a,b,c,d){var e="",f=0;b?f=b.lengt:(e=a.value||a.innerHTML,f=e.length),pos=Number(c),isNaN(pos)&&(pos=b.indexOf(c)),setTimeout(function(){if(a.setSelectionRange)d?a.setSelectionRange(pos+1,pos+1):a.setSelectionRange(pos,pos);else{var b=a.createTextRange();b.moveStart("character",-f),b.moveEnd("character",-f),d?b.moveStart("character",pos+1):b.moveStart("character",pos),b.moveEnd("character",0),b.select()}},0)},cardFormat:function(a){var b=a.toString().replace(/\s*/g,"");if(""==b)return"";b=b.split("");var c=b.length,d=0,e=1;for(d;c>d;d++)e%4==0&&e!=c&&b.splice(d,1,b[d]+" "),e++;return b.join("")},phoneFormat:function(a){var b=a.toString().replace(/\s*/g,"");if(""==b)return"";b=b.split("");var c=b.length,d=0;for(d;c>d;d++){var e=d+2;0!=d&&(2==d?b.splice(d,1,b[d]+" "):e%4==0&&e!=c+1&&b.splice(d,1,b[d]+" "))}return b.join("")},moneyAdd:function(a,b){var c,d,e,f,g=a.toString(),h=b.toString();try{c=g.split(".")[1].length}catch(i){c=0}try{d=h.split(".")[1].length}catch(i){d=0}if(f=Math.abs(c-d),e=Math.pow(10,Math.max(c,d)),f>0){var j=Math.pow(10,f);c>d?(g=Number(g.replace(/\.*/g,"")),h=Number(h.replace(/\.*/g,""))*j):(g=Number(g.replace(/\.*/g,""))*j,h=Number(h.replace(/\.*/g,"")))}else g=Number(g.replace(/\.*/g,"")),h=Number(h.toString().replace(/\.*/g,""));return(g+h)/e},moneySub:function(a,b){var c,d,e,f;try{c=a.toString().split(".")[1].length}catch(g){c=0}try{d=b.toString().split(".")[1].length}catch(g){d=0}return e=Math.pow(10,Math.max(c,d)),f=c>=d?c:d,((a*e-b*e)/e).toFixed(f)},moneyMul:function(a,b){var c=0,d=a.toString(),e=b.toString();try{c+=d.split(".")[1].length}catch(f){c+=0}try{c+=e.split(".")[1].length}catch(f){c+=0}return Number(d.replace(/\.*/g,""))*Number(e.replace(/\.*/g,""))/Math.pow(10,c)},moneyDiv:function(str1,str2){var r1,r2,t1=0,t2=0,txt1=str1.toString(),txt2=str2.toString();try{t1=txt1.split(".")[1].length}catch(e){}try{t2=txt2.split(".")[1].length}catch(e){}with(Math)return r1=Number(txt1.replace(/\.*/g,"")),r2=Number(txt1.replace(/\.*/g,"")),r1/r2*pow(10,t2-t1)}}});